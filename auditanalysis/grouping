import pandas as pd

# Load your data (CSV, Excel, or DataFrame input)
df = pd.read_csv('trades.csv')  # Change file path/name as needed

# List of columns to group by (edit as needed)
group_columns = ['column1', 'column2']  # Example: ['desk', 'product_type']

# Count number of trades by grouping
trade_counts = df.groupby(group_columns).size().reset_index(name='count')

# Display or save the result
print(trade_counts)
trade_counts.to_csv('trade_counts.csv', index=False)  # Saves output


import pandas as pd

# Example DataFrame
df = pd.DataFrame({'data': [
    'abc_has_def_has_ghi',
    'one_has_two_has_three_has_four',
    'apple_has_banana'
]})

# Create new column with last second substring
df['last_second_substring'] = df['data'].apply(lambda x: x.split('_')[-2] if len(x.split('_')) > 1 else '')

print(df)

